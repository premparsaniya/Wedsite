import{r as c,j as e,a as d}from"./jsx-runtime-911a162d.js";import{u as I,D as J,y as z,l as k,aA as H,aB as F,a as G,e as M,c as Q,Q as O,L as Y,h as K,j as W,au as X}from"./EmojiBoard-9ff11c42.js";import"./web3.min-e56af654.js";const B=c.forwardRef(({item:t,index:x,aLoading:i,rLoading:u,goProfile:g,acceptRequest:v,rejectRequest:j},N)=>{var y,f,r,h;const{user:p}=I(o=>o.UserLogin),_=e(c.Fragment,{children:e("div",{className:"notification-follow-list-box ",children:d("div",{className:"notification-follow-list",children:[e("img",{src:((y=t==null?void 0:t.sender)==null?void 0:y.photo)||J,alt:"Profile",className:"profile-size cursor-pointer",style:{marginLeft:"10px"},onClick:()=>{var o;return g((o=t==null?void 0:t.sender)==null?void 0:o.user_id)},crossOrigin:"anonymous"}),d("div",{className:"notification-flex",children:[d("div",{className:"user_name cursor-pointer",children:[d("span",{onClick:()=>{var o;return g((o=t==null?void 0:t.sender)==null?void 0:o.user_id)},children:[(f=t==null?void 0:t.sender)==null?void 0:f.name,e("span",{className:"text-sm text-gray-400 ml-1",children:t==null?void 0:t.notification})]}),e("span",{className:"notification-font",children:z.tz(t==null?void 0:t.reg_date,"MET").startOf(t==null?void 0:t.reg_date).fromNow()})]}),((h=(r=p==null?void 0:p.data)==null?void 0:r.settings)==null?void 0:h.profile)==="0"&&(t==null?void 0:t.slug)==="follow_request"?d("div",{className:"notification-btn",children:[e("div",{className:"notification-right",onClick:()=>{var o;return v((o=t==null?void 0:t.sender)==null?void 0:o.user_id)},children:i?e(k,{isLoading:i,className:"ctr"}):e("img",{src:H,alt:"Right-icon",className:"cursor-pointer"})}),e("div",{className:"notification-close",onClick:()=>{var o;return j((o=t==null?void 0:t.sender)==null?void 0:o.user_id)},children:u?e(k,{isLoading:u,className:"ctr"}):e("img",{src:F,alt:"close-icon",className:"cursor-pointer"})})]}):null]})]})})},x);return N?e("div",{ref:N,children:_}):e("div",{children:_})});function st(){const{user:t}=I(a=>a.UserLogin),{dispatch:x}=c.useContext(G),[i,u]=c.useState([]),[g,v]=c.useState(!1),[j,N]=c.useState(!1),[p,_]=c.useState(!1),[C,y]=c.useState(!1),[f,r]=c.useState(!1),[h,o]=c.useState(1),w=10,T=M(),P=Q(),b=t==null?void 0:t.token;c.useEffect(()=>{L()},[h]);const L=()=>{r(!0);const a={method:"get_notifications",user_id:t.data.user_id,page:h,limit:w};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${b}`},body:JSON.stringify(a)}).then(n=>{n.json().then(s=>{var l;if(s.status===1){let D=w,A=(l=s==null?void 0:s.data)==null?void 0:l.length;if(y(A>=D),h===1)u(s.data);else{let R=[...i];s!=null&&s.data&&R.push(...s==null?void 0:s.data),u(R)}}s.status===2&&(O.error("Your session is expired. Please login to access your account",{position:"top-center"}),T(Y()),T(K()),P("/"),W(x))}).finally(()=>r(!1))})},$=a=>{_(!0);const n={method:"accept_follow_request",user_id:t.data.user_id,user_2:a};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${b}`},body:JSON.stringify(n)}).then(s=>{s.json().then(l=>{l.status===1&&(v(!g),_(!1),L(),O.success(`${l.message}`,{position:"top-center",autoClose:300}))})})},m=a=>{N(!0);const n={method:"reject_follow_request",user_id:t.data.user_id,user_2:a};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${b}`},body:JSON.stringify(n)}).then(s=>{s.json().then(l=>{l.status===1&&(v(!g),N(!1),L(),O.success(`${l.message}`,{position:"top-center",autoClose:300}))})})},U=()=>{r(!0);const a={method:"delete_all_notifications",user_id:t.data.user_id};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${b}`},body:JSON.stringify(a)}).then(n=>{n.json().then(s=>{s.status===1&&u([]),r(!1)})})},E=a=>{P(`/userprofile/${a}`)},S=c.useRef(),q=c.useCallback(a=>{f||(S.current&&S.current.disconnect(),S.current=new IntersectionObserver(n=>{n[0].isIntersecting&&C&&o(s=>s+1)}),a&&S.current.observe(a))},[f,C]);return e("section",{className:"discover-p_m",children:d("div",{className:"discover-box",children:[d("div",{className:"relative justify-center discover-header",children:["Notification",e("img",{src:X,alt:"dlt",onClick:()=>U(),className:"absolute ml-[90%] cursor-pointer"})]}),e("div",{className:"discover-border",style:{marginBottom:"10px"}}),d("div",{className:"",style:{maxHeight:"700px",overflow:"scroll"},children:[(i==null?void 0:i.length)>0?i.map((a,n)=>(i==null?void 0:i.length)===n+1?e(B,{item:a,index:n,goProfile:E,aLoading:p,rLoading:j,acceptRequest:$,rejectRequest:m,ref:q},n):e(B,{item:a,index:n,goProfile:E,aLoading:p,rLoading:j,acceptRequest:$,rejectRequest:m},n)):!f&&e("p",{className:"text-center pt-[40%] ",children:"No notifications yet !!"}),f&&e(k,{isLoading:!0,colClass:"text-black ",size:10,className:"flex items-center justify-center w-full mb-4"})]})]})})}export{st as default};
//# sourceMappingURL=Notification-25e24793.js.map
