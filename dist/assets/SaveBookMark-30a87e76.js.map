{"version":3,"file":"SaveBookMark-30a87e76.js","sources":["../../src/pages/SaveBookMark.tsx"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Loading, SaveBookMarkContent, SpinningLoader } from \"../components\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { App_state, setPostList } from \"~/reduxState\";\nimport { BACK_ICON, EMPTY_ICON } from \"~/assets\";\nconst SaveBookMark = () => {\n  const { user } = useSelector((state: any) => state.UserLogin);\n  const postData = useSelector((s: App_state) => s?.PostListReducer);\n\n  const token = user?.token;\n  const limit = 10;\n\n  const [hasNextPage, setHasNextPage] = useState(false);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [listLoading, setListLoading] = useState<boolean>(false);\n  const [pageNo, setPageNo] = useState<number>(1);\n\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n\n  const handleBackArrow = () => {\n    navigate(-1);\n  };\n\n  // const [bPost, setBPost] = useState<any>([]);\n\n  useEffect(() => {\n    getBookMarkList();\n  }, [pageNo]);\n\n  const getBookMarkList = () => {\n    pageNo === 1 && setLoading(true);\n    setListLoading(true);\n    const obj = {\n      method: \"get_post_list\",\n      user_id: user.data.user_id,\n      page: pageNo,\n      limit: limit,\n      filter_by: {\n        bookmark: 1,\n      },\n    };\n    fetch(`${import.meta.env.VITE_API_URL}post`, {\n      method: \"POST\",\n      headers: {\n        accept: \"application/json\",\n        contentType: \"application/json\",\n        version: \"1.0.0\",\n        token: `Bearer ${token}`,\n      },\n      body: JSON.stringify(obj),\n    }).then((res) => {\n      res.json().then((response) => {\n        console.log(\"bm --->\", response);\n        if (response.status === 1) {\n          setLoading(false);\n          let pLimit = limit;\n          let pData = response?.data?.length;\n          setHasNextPage(pData >= pLimit);\n          if (pageNo === 1) {\n            dispatch(setPostList(response?.data));\n          } else {\n            let clone = [...postData];\n            response?.data && clone.push(...response?.data);\n            dispatch(setPostList(clone));\n          }\n          // console.log(\"save ----->\", response)\n        } else {\n          // console.log(\"else\", response);\n        }\n      });\n    }).finally(() => setListLoading(false));\n  };\n\n  const intObserver = useRef<any>();\n  const lastPostRef = useCallback(\n    (post: any) => {\n      if (listLoading) return;\n      if (intObserver.current) intObserver.current.disconnect();\n\n      intObserver.current = new IntersectionObserver((posts) => {        \n        if (posts[0].isIntersecting && hasNextPage) {\n          setPageNo((prev) => prev + 1);\n        }\n      });\n      if (post) intObserver.current.observe(post);\n    },\n    [listLoading, hasNextPage]\n  );\n\n  return (\n    <>\n      <div className=\"sb-header-div\">\n        <img\n          src={BACK_ICON}\n          alt=\"back\"\n          className=\"back-arrow\"\n          onClick={handleBackArrow}\n        />\n        <span className=\"page-title-span\">Save Bookmark</span>\n      </div>\n      {loading ? (\n        <div className=\"w-full h-[50vh] flex justify-center items-center\">\n          <Loading size={100} />\n        </div>\n      ) : postData?.length === 0 ? (\n        <>\n          {\" \"}\n          <div className=\"no-video-div\">\n            <img src={EMPTY_ICON} alt=\"EMpty\" className=\"no-video-icon\" />\n            <span className=\"no-video-span\">No Videos</span>\n          </div>\n        </>\n      ) : (\n        <>\n          <div className=\"sb-content-div\">\n            {postData?.length > 0\n              ? postData.map((item: any, index: number) => {\n                return postData?.length === index + 1 ? (\n                  <SaveBookMarkContent\n                    key={index}\n                    index={index}\n                    item={item}\n                    ref={lastPostRef}\n                    getBookMarkList={getBookMarkList}\n                  />\n                ) : (\n                  <SaveBookMarkContent\n                    key={index}\n                    index={index}\n                    item={item}\n                    getBookMarkList={getBookMarkList}\n                  />\n                );\n              })\n              : !listLoading && <p>No users yet !!</p>}\n            {listLoading && (\n              <SpinningLoader\n                isLoading\n                colClass=\"text-black\"\n                size={10}\n                className=\"mb-4 w-full flex justify-center items-center\"\n              />\n            )}\n          </div>\n        </>\n      )}\n    </>\n  );\n};\n\nexport default SaveBookMark;\n"],"names":["SaveBookMark","user","useSelector","state","postData","s","token","limit","hasNextPage","setHasNextPage","useState","loading","setLoading","listLoading","setListLoading","pageNo","setPageNo","navigate","useNavigate","dispatch","useDispatch","handleBackArrow","useEffect","getBookMarkList","obj","res","response","pLimit","pData","_a","setPostList","clone","intObserver","useRef","lastPostRef","useCallback","post","posts","prev","jsxs","Fragment","jsx","BACK_ICON","Loading","EMPTY_ICON","item","index","SaveBookMarkContent","SpinningLoader"],"mappings":"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"}