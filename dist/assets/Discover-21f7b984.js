import{r as c,j as o,a as S}from"./jsx-runtime-911a162d.js";import{u as lt,D as rt,F as ft,o as V,a as _t,e as ht,c as ut,az as vt,Q as gt,L as pt,h as wt,j as Nt,S as St,l as tt,P as xt}from"./EmojiBoard-9ff11c42.js";import"./web3.min-e56af654.js";import{I as yt}from"./index-79255bbd.js";const kt="/assets/filter-15b75b6f.svg",Ct="/assets/check_circle-6bdec914.svg",Pt=({closePopup:n,visible:q,setSelectedValue:b,apiFunction:x})=>{const O=[{id:0,name:"Normal"},{id:1,name:"Most Liked"},{id:2,name:"Most Commented"},{id:3,name:"Most Bookmarked"},{id:4,name:"Most Viewed"},{id:5,name:"Most Shared"},{id:6,name:" Most Popular"}],[v,_]=c.useState(!1),[p,s]=c.useState(),k=(g,d)=>{_(d),d&&s(g==null?void 0:g.id),b(g==null?void 0:g.name),n(),x()};return o(yt,{visible:q,onClose:n,onSave:()=>n(),saveBtnTxt:"Close",hideClose:!0,subClass:"lg:w-3/12 md:w-7/12 XL:w-5/12 px-0 pt-0 ",children:o("div",{className:"filter-popup-contain",children:o("div",{className:"filter-popup-message-div",children:O.map((g,d)=>o(c.Fragment,{children:S("div",{className:"pl-[5%] filter-title select-none ",onClick:g.id==p?()=>k(g,!1):()=>k(g,!0),children:[o("div",{className:"filter-popup-title-span",children:g.name}),o("div",{children:g.id==p&&o("img",{src:Ct,alt:"checl",onClick:()=>k(g,!0)})})]})},d))})})})},at=c.forwardRef(({item:n,index:q,isDecibel:b,userData:x,goProfile:O,setUserData:v,setIsDecibel:_},p)=>{const{user:s}=lt(P=>P.UserLogin),k=s==null?void 0:s.token,[g,d]=c.useState(!1),z=(P,G,t)=>{var J,U,j,M,B,L;if(P==V.typeFollow){d(!0),_(t==null?void 0:t.user_id);const y={method:"do_follow",user_id:(J=s==null?void 0:s.data)==null?void 0:J.user_id,user_2:t==null?void 0:t.user_id};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${k}`},body:JSON.stringify(y)}).then(w=>{w.json().then(e=>{var u,h;if(e.status===1){d(!1),_("");let r=[...x],N=r.findIndex(f=>(f==null?void 0:f.user_id)===(t==null?void 0:t.user_id));r[N]={...t,user_1_follow_request:(u=e==null?void 0:e.extra)==null?void 0:u.user_1_follow_request,user_2_follow_request:(h=e==null?void 0:e.extra)==null?void 0:h.user_2_follow_request},v(r)}else d(!1),_("")})})}else if(P==V.typeUnfollow){d(!0),_(t==null?void 0:t.user_id);const y={method:"unfollow",user_id:(U=s==null?void 0:s.data)==null?void 0:U.user_id,user_2:t==null?void 0:t.user_id};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${k}`},body:JSON.stringify(y)}).then(w=>{w.json().then(e=>{var u,h;if(e.status===1){d(!1),_("");let r=[...x],N=r.findIndex(f=>(f==null?void 0:f.user_id)===(t==null?void 0:t.user_id));r[N]={...t,user_1_follow_request:(u=e==null?void 0:e.extra)==null?void 0:u.user_1_follow_request,user_2_follow_request:(h=e==null?void 0:e.extra)==null?void 0:h.user_2_follow_request},v(r)}else d(!1),_("")})})}else if(P==V.typeFollowBack){d(!0),_(t==null?void 0:t.user_id);const y={method:"do_follow",user_id:(j=s==null?void 0:s.data)==null?void 0:j.user_id,user_2:t==null?void 0:t.user_id};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${k}`},body:JSON.stringify(y)}).then(w=>{w.json().then(e=>{var u,h;if(e.status===1){d(!1),_("");let r=[...x],N=r.findIndex(f=>(f==null?void 0:f.user_id)===(t==null?void 0:t.user_id));r[N]={...t,user_1_follow_request:(u=e==null?void 0:e.extra)==null?void 0:u.user_1_follow_request,user_2_follow_request:(h=e==null?void 0:e.extra)==null?void 0:h.user_2_follow_request},v(r)}else d(!1),_("")})})}else if(P==V.typeRequestSent){d(!0),_(t==null?void 0:t.user_id);const y={method:"cancel_follow_request",user_id:(M=s==null?void 0:s.data)==null?void 0:M.user_id,user_2:t==null?void 0:t.user_id};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${k}`},body:JSON.stringify(y)}).then(w=>{w.json().then(e=>{var u,h;if(e.status===1){d(!1),_("");let r=[...x],N=r.findIndex(f=>(f==null?void 0:f.user_id)===(t==null?void 0:t.user_id));r[N]={...t,user_1_follow_request:(u=e==null?void 0:e.extra)==null?void 0:u.user_1_follow_request,user_2_follow_request:(h=e==null?void 0:e.extra)==null?void 0:h.user_2_follow_request},v(r)}else d(!1),_("")})})}else if(P==V.typeGotRequest)if(d(!0),_(t==null?void 0:t.user_id),G==="accept"){const y={method:"accept_follow_request",user_id:(B=s==null?void 0:s.data)==null?void 0:B.user_id,user_2:t==null?void 0:t.user_id};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${k}`},body:JSON.stringify(y)}).then(w=>{w.json().then(e=>{var u,h;if(e.status===1){d(!1),_("");let r=[...x],N=r.findIndex(f=>(f==null?void 0:f.user_id)===(t==null?void 0:t.user_id));r[N]={...t,user_1_follow_request:(u=e==null?void 0:e.extra)==null?void 0:u.user_1_follow_request,user_2_follow_request:(h=e==null?void 0:e.extra)==null?void 0:h.user_2_follow_request},v(r)}else d(!1),_("")})})}else{d(!0),_(t==null?void 0:t.user_id);const y={method:"reject_follow_request",user_id:(L=s==null?void 0:s.data)==null?void 0:L.user_id,user_2:t==null?void 0:t.user_id};fetch("https://nwo.capital/app/state/api/profile",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${k}`},body:JSON.stringify(y)}).then(w=>{w.json().then(e=>{var u,h;if(e.status===1){d(!1),_("");let r=[...x],N=r.findIndex(f=>(f==null?void 0:f.user_id)===(t==null?void 0:t.user_id));r[N]={...t,user_1_follow_request:(u=e==null?void 0:e.extra)==null?void 0:u.user_1_follow_request,user_2_follow_request:(h=e==null?void 0:e.extra)==null?void 0:h.user_2_follow_request},v(r)}else d(!1),_("")})})}},C=S("div",{className:"discover-follow-list-box",children:[S("div",{className:"discover-follow-list",children:[S("div",{className:"discover-follow-list-flex",onClick:()=>O(n==null?void 0:n.user_id),children:[o("img",{src:(n==null?void 0:n.photo)||rt,alt:"Profile",className:"profile-size cursor-pointer",crossOrigin:"anonymous"}),o("div",{className:"user_name cursor-pointer",children:n==null?void 0:n.name})]}),o(ft,{followBtnClick:z,user1:n==null?void 0:n.user_1_follow_request,user2:n==null?void 0:n.user_2_follow_request,userItem:n,loading:g,isDecibel:b},n)]}),o("div",{className:"discover-border-gray"})]},q);return p?o("div",{ref:p,children:C}):o("div",{children:C})}),et=c.forwardRef(({item:n,index:q,showPostDetailsClick:b},x)=>{const O=o(c.Fragment,{children:o("div",{className:"discover-video overflow-hidden",onClick:()=>b(n),children:o("img",{src:n.att_thumb,alt:"",className:"h-full w-full object-cover cursor-pointer",crossOrigin:"anonymous"})})},q);return x?o("div",{ref:x,children:O}):o("div",{children:O})});function bt(){const{user:n}=lt(l=>l.UserLogin),q=n==null?void 0:n.token,{dispatch:b}=c.useContext(_t),x=ht(),O=ut(),[v,_]=c.useState("user"),[p,s]=c.useState([]);c.useState([]);const[k,g]=c.useState(""),[d,z]=c.useState(!1),[C,A]=c.useState([]),[P,G]=c.useState(""),[t,J]=c.useState(!1),[U,j]=c.useState(),[M,B]=c.useState(),[L,y]=c.useState(!1),[w,e]=c.useState({}),u=vt(k,700),[h,r]=c.useState(1),[N,f]=c.useState(!1),[$,X]=c.useState(!1),[Y,W]=c.useState(""),H=10;c.useEffect(()=>{it()},[t]),c.useEffect(()=>{ot(),Z()},[u,P,h,v,t]);const ot=()=>{X(!0);const l={method:"get_all_users",page:h,limit:H,search:u};fetch("https://nwo.capital/app/state/api/user",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${q}`},body:JSON.stringify(l)}).then(i=>{i.json().then(a=>{var T;if(a.status===1){let F=H,Q=(T=a==null?void 0:a.data)==null?void 0:T.length;if(f(Q>=F),h===1)s(a.data);else{let E=[...p];a!=null&&a.data&&E.push(...a==null?void 0:a.data),s(E)}}a.status===2&&(gt.error("Your session is expired. Please login to access your account",{position:"top-center"}),x(pt()),x(wt()),O("/"),Nt(b))}).finally(()=>X(!1))}).catch(i=>{console.error("error")})},it=()=>{const l={method:"get_post_count"};fetch("https://nwo.capital/app/state/api/post",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${q}`},body:JSON.stringify(l)}).then(i=>{i.json().then(a=>{var T,F;a.status===1?(st((T=a==null?void 0:a.data)==null?void 0:T.user_count),dt((F=a==null?void 0:a.data)==null?void 0:F.post_count)):console.log("error")})}).catch(i=>{console.error("error")})},R=c.useRef(),ct=c.useCallback(l=>{$||(R.current&&R.current.disconnect(),R.current=new IntersectionObserver(i=>{i[0].isIntersecting&&N&&r(a=>a+1)}),l&&R.current.observe(l))},[$,N]),K=c.useRef(),nt=c.useCallback(l=>{$||(K.current&&K.current.disconnect(),K.current=new IntersectionObserver(i=>{i[0].isIntersecting&&N&&r(a=>a+1)}),l&&R.current.observe(l))},[$,N]),Z=()=>{const l={method:"get_post_list",page:h,limit:H,search:u,filter_by:P};fetch("https://nwo.capital/app/state/api/post",{method:"POST",headers:{accept:"application/json",contentType:"application/json",version:"1.0.0",token:`Bearer ${q}`},body:JSON.stringify(l)}).then(i=>{i.json().then(a=>{var T;if(a.status===1){let F=H,Q=(T=a==null?void 0:a.data)==null?void 0:T.length;if(f(Q>=F),h===1)A(a.data);else{let E=[...C];a!=null&&a.data&&E.push(...a==null?void 0:a.data),A(E)}}})}).catch(i=>{console.log("error")})},D=()=>{z(!d)},m=l=>{e(l),y(!L)},I=l=>{O(`/userprofile/${l}`)},st=l=>{if(l=l.toString().replace(/[^0-9.]/g,""),l<1e3)return j(l);let i=[{v:1e3,s:"K"},{v:1e6,s:"M"},{v:1e9,s:"B"},{v:1e12,s:"T"},{v:1e15,s:"P"},{v:1e18,s:"E"}],a;for(a=i.length-1;a>0&&!(l>=i[a].v);a--);return j((l/i[a].v).toFixed(2).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+i[a].s)},dt=l=>{if(l=l.toString().replace(/[^0-9.]/g,""),l<1e3)return B(l);let i=[{v:1e3,s:"K"},{v:1e6,s:"M"},{v:1e9,s:"B"},{v:1e12,s:"T"},{v:1e15,s:"P"},{v:1e18,s:"E"}],a;for(a=i.length-1;a>0&&!(l>=i[a].v);a--);return B((l/i[a].v).toFixed(2).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+i[a].s)};return S("section",{className:"discover-p_m",children:[S("div",{className:"discover-box",children:[o("div",{className:"discover-header",children:"Discover"}),o("div",{className:"discover-border"}),S("div",{className:"discover-uv",children:[o("div",{className:"discover-title",children:S("ul",{className:"segmented-control",children:[S("li",{className:"segmented-control__item",onClick:()=>_("user"),children:[o("input",{className:"segmented-control__input",type:"radio",value:"user",name:"option",id:"option-1",checked:v==="user",onChange:()=>{}}),S("label",{className:"segmented-control__label",htmlFor:"option-1",children:["User (",U||0,")"]})]}),S("li",{className:"segmented-control__item",onClick:()=>_("video"),children:[o("input",{className:"segmented-control__input",type:"radio",value:"video",name:"option",id:"option-2",checked:v==="video",onChange:()=>{}}),S("label",{className:"segmented-control__label",htmlFor:"option-2",children:["Videos (",M||0,")"]})]})]})}),S("div",{className:"discover-search-flex",children:[S("div",{className:"mb-2 discover-search-bar",children:[o("img",{src:St,alt:"Search",className:"navbar__icon mr-2.5 ml-2.5"}),o("input",{value:k,className:"search-box ",placeholder:"Search",onChange:l=>g(l.target.value)})]}),v==="video"&&o("div",{className:"discover-filter",onClick:()=>D(),children:o("img",{src:kt,alt:"filter"})})]}),o(Pt,{visible:d,closePopup:D,setSelectedValue:G,apiFunction:Z}),S("div",{className:"",style:{height:"620px",overflow:"scroll"},children:[v==="user"&&(p==null?void 0:p.length)>0?p.map((l,i)=>(p==null?void 0:p.length)===i+1?o(at,{item:l,index:i,goProfile:I,userData:p,setUserData:s,ref:ct,isDecibel:Y,setIsDecibel:W},i):o(at,{item:l,goProfile:I,index:i,userData:p,setUserData:s,isDecibel:Y,setIsDecibel:W},i)):!$&&v==="user"&&o("p",{children:"No user yet !!"}),$&&v==="user"&&o(tt,{isLoading:!0,colClass:"text-black",size:10,className:"flex items-center justify-center w-full mb-4"}),v==="video"&&o("div",{className:"discover-video-list-box",children:(C==null?void 0:C.length)>0?C.map((l,i)=>(C==null?void 0:C.length)===i+1?o(et,{item:l,index:i,showPostDetailsClick:m,ref:nt},i):o(et,{item:l,index:i,showPostDetailsClick:m},i)):!$&&v==="video"&&o("p",{className:"flex items-center justify-center w-full text-xl text-center text-gray-500 h-52 text-bold",children:"No video yet !!"})}),$&&v==="video"&&o(tt,{isLoading:!0,colClass:"text-black",size:10,className:"flex items-center justify-center w-full mb-4"})]})]})]}),L&&o(xt,{value:w,closeToggle:y,setHandleGP:J,handleGP:t},w==null?void 0:w.post_id)]})}export{bt as default};
//# sourceMappingURL=Discover-21f7b984.js.map
